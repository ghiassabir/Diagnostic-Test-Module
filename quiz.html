<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Bluebook Quiz Player</title>
    <style>
        /* All your existing CSS from before. It's correct. */
        :root {
            --bluebook-dark-blue: #0d2f5a;
            /* ... etc ... */
            --bluebook-card-bg: #ffffff;
        }
        /* ... all other CSS rules ... */
        .review-q-grid { display: flex; flex-wrap: wrap; gap: 0.75rem; }
    </style>
    <!-- MathJax Configuration -->
    <script>
    MathJax = {
      tex: { inlineMath: [['$', '$'], ['\\(', '\\)']] },
      svg: { fontCache: 'global' }
    };
    </script>
    <script type="text/javascript" id="MathJax-script" async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>
</head>
<body>
    <div class="app-wrapper">

        <!-- Email Input View (Shown first if no email in localStorage) -->
        <div class="app-view fullscreen-transition-view" id="email-input-view">
            <div style="background-color: white; padding: 2.5rem; border-radius: 0.75rem; box-shadow: 0 4px 12px rgba(0,0,0,0.1); max-width: 400px; text-align: center;">
                <h2 style="font-size: 1.75rem; font-weight: bold; margin-bottom: 1rem; color: var(--bluebook-dark-blue);">Enter Your Email</h2>
                <p style="font-size: 1rem; color: var(--bluebook-light-text); margin-bottom: 1.5rem;">Please enter your email to start or continue your session.</p>
                <input type="email" id="student-email-field" placeholder="your.email@example.com" style="width: 100%; padding: 0.75rem; border: 1px solid var(--bluebook-border-color); border-radius: 0.375rem; margin-bottom: 1.5rem; font-size: 1rem;">
                <button id="submit-email-btn" class="modal-button yellow" style="padding: 0.75rem 3rem; width: 100%;">Continue</button>
            </div>
        </div>
        
        <!-- Fallback Home View (Shown if quiz.html is opened without parameters) -->
        <div class="app-view home-screen-view active" id="home-view">
            <header class="app-header">
                <div class="logo">Bluebook</div>
                <div class="user-info">
                    <div class="user-avatar" id="user-avatar-initials"></div>
                    <span id="home-user-name"></span> 
                </div>
            </header>
            <main class="main-home-content" style="display: flex; flex-direction: column; align-items: center; justify-content: center; text-align: center;">
                <h1 style="font-size: 1.75rem; font-weight: bold; margin-bottom: 1rem; color: var(--bluebook-dark-blue);">Bluebook Quiz Player</h1>
                <p class="subtitle" style="font-size: 1rem; color: var(--bluebook-light-text); margin-bottom: 1.5rem; max-width: 500px;">Please access tests and quizzes through the main SAT Hub portal or a direct link.</p>
            </main>
        </div> 

        <!-- Test Interface View -->
        <div class="app-view test-interface-view" id="test-interface-view">
            <header class="app-header">
                <!-- ... existing header content ... -->
            </header>
            <div class="test-preview-banner">THIS IS A TEST PREVIEW</div>
            <main class="main-content-area" id="main-content-area-dynamic">
                <div class="passage-pane custom-scrollbar" id="passage-pane">
                    <img id="passage-image" src="" alt="Question-related image" class="hidden" style="max-width: 80%; height: auto; margin: 0 auto 1rem auto; border: 1px solid var(--bluebook-border-color); border-radius: 0.25rem;">
                    <div class="passage-content" id="passage-content"></div> 
                </div>
                <div class="spr-instructions-pane custom-scrollbar" id="spr-instructions-pane">
                    <div class="spr-instructions-content" id="spr-instructions-content"></div>
                </div>
                <div class="pane-divider-draggable" id="pane-divider-draggable"></div>
                <div class="question-pane custom-scrollbar" id="question-pane">
                    <div class="question-header">
                        <!-- ... existing question header ... -->
                    </div>
                    <img id="stem-image" src="" alt="Question-related image" class="hidden" style="max-width: 80%; height: auto; margin: 0 auto 1rem auto; border: 1px solid var(--bluebook-border-color); border-radius: 0.25rem;">
                    <div class="question-text" id="question-text-main"></div>
                    <div id="answer-area">
                        <!-- ... existing answer area ... -->
                    </div>
                </div>
            </main>
            <footer class="app-footer">
                <!-- ... existing footer content ... -->
            </footer>
        </div>

        <!-- Other Views (Module Over, Finished, Review Page) -->
        <!-- ... Make sure these are all present as they were before ... -->
        
        <!-- Modals Container -->
        <div id="modals-container">
            <!-- ... All your modals ... -->
        </div>

        <!-- Calculator & Reference Sheet Overlays -->
        <!-- ... -->

    </div>

    <script src="script.js"></script> 
</body>
</html>
